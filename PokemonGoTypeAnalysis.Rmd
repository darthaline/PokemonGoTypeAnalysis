---
title: "Pokemon Go Type Analysis"
author: "darthaline"
date: "28 Sept 2020"
output:
  html_notebook:
    toc: true
---
# Pokemon Go Type Analysis

## DPS data lvl 40

```{r DPSData}
theurl <- "https://gamepress.gg/pokemongo/comprehensive-dps-spreadsheet"
dpsData <- read.csv(file.path('data', 'comprehensive_dps.csv'))
rm(theurl)
dpsData
```

## Typing data

```{r StatsData}
theurl <- "https://www.kaggle.com/netzuel/pokmon-go-dataset-15-generations"
statsData <- read.csv(file.path('data', 'pogo.csv'))
rm(theurl)
statsData$Secondary[statsData$Secondary == 'None'] <- NA
statsData
```

```{r typeList}
types <- as.character(unique(statsData$Primary))
types <- tolower(types)
types <- sort(types)
types
```

```{r typeData, eval=FALSE}
library(rvest)

theurl <- "https://pokemondb.net/pokedex/all"
source_tables <- read_html(theurl)
typeData <- html_nodes(source_tables, ".data-table")
typeData <- html_table(typeData[[1]], fill = TRUE)
typeData

write.table(typeData, file = file.path('data', 'pokedex.csv'), sep = ',', row.names=FALSE)

rm(theurl, source_tables)
```

```{r effectivenessData}
theurl <- "https://docs.google.com/spreadsheets/d/1dlXr-i300HAWEekKQltdJQsll7keoKhsjuRDKft2F0U/edit?usp=sharing"
effectivenessData <- read.csv(file.path('data', 'pokemon go type effectiveness chart.csv'), skip = 4)
rm(theurl)

effectivenessData <- effectivenessData[!names(effectivenessData) %in% c('poison.dark', 'geom.att')]
effectivenessData <- effectivenessData[-dim(effectivenessData)[2],]
effectivenessData
```

```{r pokemonTypes, warning=FALSE, eval=FALSE}
pokemon <- 'Stunky'
pokemonTypes <- c(as.character(statsData[statsData$Name == pokemon,]$Primary),
               as.character(statsData[statsData$Name == pokemon,]$Secondary))
pokemonTypes <- pokemonTypes[!is.na(pokemonTypes)]
pokemonTypes <- tolower(pokemonTypes)
pokemonTypes <- sort(pokemonTypes)
pokemonTypes
```

```{r moveTypeInputs}
#input 2 movetypes, sort alphabetically
moveTypes <- c('poison', 'dark')
moveTypes <- c('ghost', 'psychic')
moveTypes <- sort(moveTypes)
moveTypes
```

```{r, warning=FALSE}
#selecting moveTypes
tempEffectiveness <- effectivenessData[effectivenessData$attacking.defending %in% moveTypes,]

# calculating the product of the two movetypes
tempEffectivenessProduct <- unlist(lapply(tempEffectiveness[!names(tempEffectiveness) %in% c('attacking.defending')], prod))

# removing factoring
tempEffectiveness$attacking.defending <- as.character(tempEffectiveness$attacking.defending)

#merging movetypes to make a name in the data frame
rowtitleProduct <- paste(moveTypes, collapse = ' & ')
tempEffectiveness <- rbind(tempEffectiveness, c(rowtitleProduct, tempEffectivenessProduct))

# selecting columns which provide defence against combination of those move types
tempEffectiveness <- tempEffectiveness[, colnames(tempEffectiveness) == 'attacking.defending' |
                                         tempEffectiveness[tempEffectiveness$attacking.defending == rowtitleProduct,] < 1]
tempEffectiveness
rm(tempEffectivenessProduct, rowtitleProduct)

```

```{r, warning=FALSE}
#making a copy without the merged double types, after selecting the resisting types
tempEffectiveness2 <- tempEffectiveness[-dim(tempEffectiveness)[1],]

#creating logic dataframe checking if each individual type is a resistor
tempEffectiveness2Logic <- data.frame(tempEffectiveness2 < 1)
tempEffectiveness2Logic$attacking.defending <- tempEffectiveness2$attacking.defending
tempEffectiveness2Logic

#making a list of single type resistors
singleTypeResistors <- c()

#making lists of dual type resistors
dualTypeResistorsFirsts <- c()
dualTypeResistorsSeconds <- c()

#if all the values in the column in tempEffectiveness2Logic are TRUE,
#then we can add corresponding type to the list of single type resistors
for (i in 2:dim(tempEffectiveness)[2]){
    if ( all(unlist(tempEffectiveness2Logic[i])) ){
        singleTypeResistors <- c(singleTypeResistors, colnames(tempEffectiveness2Logic)[i])
    } else {
        if (tempEffectiveness2Logic[1,i]) {
            dualTypeResistorsFirsts <- c(dualTypeResistorsFirsts, colnames(tempEffectiveness2Logic)[i])
        } else {
            dualTypeResistorsSeconds<- c(dualTypeResistorsSeconds, colnames(tempEffectiveness2Logic)[i])
        }
        
    }
}

dualTypeResistors <- expand.grid(dualTypeResistorsFirsts, dualTypeResistorsSeconds)
```

```{r}
singleTypeResistors
```
```{r}
dualTypeResistors
```







